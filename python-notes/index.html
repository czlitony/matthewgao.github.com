<!doctype html>
<html class="theme-next use-motion theme-next-mist">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>



  <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.3"/>




  <meta name="keywords" content="python," />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.3" />



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    analytics: {
      google: ''
    },
    sidebar: 'post'
  };
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?0d7319169ed36fc7c6c76a85b1353472";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <title> Python Notes // Matthew Note </title>
</head>

<body>
  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->

  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">Matthew Note</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<div class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/">
            <i class="menu-item-icon icon-home"></i> <br />
            首頁
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            <i class="menu-item-icon icon-categories"></i> <br />
            分類
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            <i class="menu-item-icon icon-about"></i> <br />
            關於
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            <i class="menu-item-icon icon-archives"></i> <br />
            歸檔
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            <i class="menu-item-icon icon-tags"></i> <br />
            標籤
          </a>
        </li>
      
    </ul>
  

  
</div>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          

  <div id="posts" class="posts-expand">
    

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              Python Notes
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-10-19
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; 分類於
            
              <a href="/categories/Python/">Python</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        <h2 id="Pypi镜像">Pypi镜像</h2><p>解决国内访问pypi速度慢的问题，注意要加上<code>--trusted-host pypi.mirrors.ustc.edu.cn</code> 因为有些不提供安全连接，或者证书不可信</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">http:</span><span class="comment">//pypi.douban.com/simple  豆瓣</span></span><br><span class="line"><span class="string">http:</span><span class="comment">//pypi.hustunique.com/simple  华中理工大学</span></span><br><span class="line"><span class="string">http:</span><span class="comment">//pypi.sdutlinux.org/simple 山东理工大学</span></span><br><span class="line"><span class="string">http:</span><span class="comment">//pypi.mirrors.ustc.edu.cn/simple 中国科学技术大学</span></span><br></pre></td></tr></table></figure>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3.<span class="number">4</span> install -<span class="tag">i</span> http:<span class="comment">//pypi.mirrors.ustc.edu.cn/simple --trusted-host pypi.mirrors.ustc.edu.cn  flask-restful</span></span><br></pre></td></tr></table></figure>
<h2 id="模块">模块</h2><h3 id="from_import">from import</h3><ul>
<li>如果module1中有变量X，module2用from来导入module1，则在赋值X的时候并不会改动module1中的X，而用import可以。</li>
<li>from会导致reload失效，因为from导入的模块拿的只是一个被reload的引用，必须在reload之后再执行一次from import</li>
</ul>
<h2 id="类">类</h2><ul>
<li>子类并不会自动调用父类的构造函数，需要显示的调用。</li>
<li>类的赋值操作并不会查询搜索树。</li>
<li><strong>init</strong> 函数不支持重载，因为python支持可变参数</li>
<li>两个下划线开头的是伪私有类属性, 他会变成_ClassName__X</li>
</ul>
<h3 id="内建属性">内建属性</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">__class__</span> <span class="comment"># 返回类名</span></span><br><span class="line">__base__ <span class="comment"># 父类</span></span><br><span class="line">__dict__ <span class="comment"># 属性字典，dir()</span></span><br><span class="line">__slot__ <span class="comment"># 禁止生成dict树</span></span><br><span class="line">__getattr__ <span class="comment"># X.undefined</span></span><br><span class="line">__getattribute__ <span class="comment"># X.any</span></span><br><span class="line">__contain__ <span class="comment"># item in X</span></span><br><span class="line">__call__ <span class="comment"># 可以直接这样使用 class_object_name()</span></span><br></pre></td></tr></table></figure>
<h3 id="委托">委托</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delegate</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.action() <span class="comment">#action需要被实现</span></span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Provider</span><span class="params">(Super)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">action</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'in provider.action'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="函数">函数</h2><h3 id="闭包">闭包</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">    _x = <span class="string">"attr"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printf</span><span class="params">()</span>:</span></span><br><span class="line">        print(_x)</span><br><span class="line">    <span class="keyword">return</span> printf</span><br></pre></td></tr></table></figure>
<h2 id="Decorator">Decorator</h2><h3 id="Singleton">Singleton</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">singleton</span><span class="params">(cls, *args, **kw)</span>:</span>   </span><br><span class="line">    _instance = &#123;&#125; </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">()</span>:</span> </span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> _instance:   </span><br><span class="line">            _instance[cls] = cls(*args, **kw)   </span><br><span class="line">        <span class="keyword">return</span> _instance[cls]      </span><br><span class="line">    <span class="keyword">return</span> wrapper                 </span><br><span class="line"></span><br><span class="line"><span class="decorator">@singleton </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(gentoo.LXRPClientHandler)</span>:</span></span><br></pre></td></tr></table></figure>
<ul>
<li>缺点是MyClass实际上是一个函数（wrapper），所以不能直接通过MyClass取类中属性</li>
<li><p>且<code>m = MyClass(); n = MyClass(); o = type(n)(); then m == n &amp;&amp; m != o &amp;&amp; n != o</code></p>
</li>
<li><p><code>@staticmethod</code>不需要表示自身对象的self和自身类的cls参数，就跟使用函数一样。</p>
</li>
<li><code>@classmethod</code>也不需要self参数，但第一个参数需要是表示自身类的cls参数。</li>
</ul>
<h2 id="规范">规范</h2><h3 id="命名规则">命名规则</h3><table>
<thead>
<tr>
<th style="text-align:center">Type</th>
<th style="text-align:center">Public</th>
<th style="text-align:center">Internal</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Modules</td>
<td style="text-align:center">lower_with_under</td>
<td style="text-align:center">_lower_with_under</td>
</tr>
<tr>
<td style="text-align:center">Packages</td>
<td style="text-align:center">lower_with_under</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">Classes</td>
<td style="text-align:center">CapWords</td>
<td style="text-align:center">_CapWords</td>
</tr>
<tr>
<td style="text-align:center">Exceptions</td>
<td style="text-align:center">CapWords</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">Functions</td>
<td style="text-align:center">lower_with_under()</td>
<td style="text-align:center">_lower_with_under()</td>
</tr>
<tr>
<td style="text-align:center">Global/Class Constants</td>
<td style="text-align:center">CAPS_WITH_UNDER</td>
<td style="text-align:center">_CAPS_WITH_UNDER</td>
</tr>
<tr>
<td style="text-align:center">Global/Class Variables</td>
<td style="text-align:center">lower_with_under</td>
<td style="text-align:center">_lower_with_under</td>
</tr>
<tr>
<td style="text-align:center">Instance Variables</td>
<td style="text-align:center">lower_with_under</td>
<td style="text-align:center">_lower_with_under (protected) or __lower_with_under (private)</td>
</tr>
<tr>
<td style="text-align:center">Method Names</td>
<td style="text-align:center">lower_with_under()</td>
<td style="text-align:center">_lower_with_under() (protected) or __lower_with_under() (private)</td>
</tr>
<tr>
<td style="text-align:center">Function/Method Parameters</td>
<td style="text-align:center">lower_with_under</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">Local Variables</td>
<td style="text-align:center">lower_with_under</td>
</tr>
</tbody>
</table>
<ol>
<li><code>single_trailing_underscore_</code> : used by convention to avoid conflicts with Python keyword, e.g.</li>
</ol>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tkinter.<span class="function"><span class="title">Toplevel</span><span class="params">(master, class_=<span class="string">'ClassName'</span>)</span></span></span><br></pre></td></tr></table></figure>
<ol>
<li><p><code>__double_leading_underscore</code> : when naming a class attribute, invokes name mangling (inside class FooBar, <strong>boo becomes _FooBar</strong>boo).</p>
</li>
<li><p><code>__double_leading_and_trailing_underscore__</code> : “magic” objects or attributes that live in user-controlled namespaces. E.g. <strong>init</strong> , <strong>import</strong> or <strong>file</strong> . Never invent such names; only use them as documented.</p>
</li>
<li><p><code>_single_leading_underscore</code> : weak “internal use” indicator. E.g. from M import * does not import objects whose name starts with an underscore.</p>
</li>
</ol>
<h3 id="编程规范">编程规范</h3><ul>
<li>每行80字符，注释72字符</li>
<li>参数多的时候要换行，少数情况下要用<code>\</code></li>
<li>使用 <code>if not alist</code> 检查是否为空，而不是用<code>if len(alist) == 0</code></li>
</ul>
<h3 id="import顺序">import顺序</h3><p>不要一行import多个包</p>
<p>Imports should be grouped in the following order:</p>
<ol>
<li>standard library imports</li>
<li>related third party imports</li>
<li>local application/library specific imports</li>
<li>Wildcard imports ( from <module> import * ) should be avoided</module></li>
</ol>
<h3 id="类设计">类设计</h3><p>如果在不确定函数或者属性是public还是non-public，尽量还是先声明为non-public，从non到public很容易，反过来则很难</p>
<h3 id="Programming_Recommendations">Programming Recommendations</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x)</span>:</span> <span class="keyword">return</span> <span class="number">2</span>*x</span><br><span class="line"></span><br><span class="line">No:</span><br><span class="line"></span><br><span class="line">f = <span class="keyword">lambda</span> x: <span class="number">2</span>*x</span><br></pre></td></tr></table></figure>
<p>The first form means that the name of the resulting function object is specifically ‘f’ instead of the generic ‘<lambda>‘. This is more useful for tracebacks and string representations in general. The use of the assignment statement eliminates the sole benefit a lambda expression can offer over an explicit def statement (i.e. that it can be embedded inside a larger expression)</lambda></p>
<ul>
<li>Use exception chaining appropriately. In Python 3, “raise X from Y” should be used to indicate explicit replacement without losing the original traceback.</li>
<li>Derive exceptions from Exception rather than BaseException . Direct inheritance from BaseException is reserved for exceptions where catching them is almost always the wrong thing to do.</li>
<li>Additionally, for all try/except clauses, limit the try clause to the absolute minimum amount of code necessary. Again, this avoids masking bugs.</li>
</ul>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Yes:</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    value = collection[<span class="keyword">key</span>]</span><br><span class="line">except KeyError:</span><br><span class="line">    <span class="keyword">return</span> key_not_found(<span class="keyword">key</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">return</span> handle_value(value)</span><br><span class="line">No:</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="preprocessor"># Too broad!</span></span><br><span class="line">    <span class="keyword">return</span> handle_value(collection[<span class="keyword">key</span>])</span><br><span class="line">except KeyError:</span><br><span class="line">    <span class="preprocessor"># Will also catch KeyError raised by handle_value()</span></span><br><span class="line">    <span class="keyword">return</span> key_not_found(<span class="keyword">key</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>Object type comparisons should always use isinstance() instead of comparing types directly.</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Yes: <span class="keyword">if</span> <span class="function"><span class="title">isinstance</span><span class="params">(obj, int)</span></span>:</span><br><span class="line"></span><br><span class="line">No:  <span class="keyword">if</span> <span class="function"><span class="title">type</span><span class="params">(obj)</span></span> is <span class="function"><span class="title">type</span><span class="params">(<span class="number">1</span>)</span></span>:</span><br></pre></td></tr></table></figure>
<ul>
<li>For sequences, (strings, lists, tuples), use the fact that empty sequences are false.</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Yes: <span class="keyword">if</span> not seq:</span><br><span class="line">     <span class="keyword">if</span> seq:</span><br><span class="line"></span><br><span class="line">No: <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(seq)</span></span></span><br><span class="line">    <span class="keyword">if</span> not <span class="function"><span class="title">len</span><span class="params">(seq)</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>Don’t compare boolean values to True or False using == .</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">Yes:</span>   <span class="keyword">if</span> <span class="string">greeting:</span></span><br><span class="line"><span class="string">No:</span>    <span class="keyword">if</span> greeting == <span class="string">True:</span></span><br><span class="line"><span class="string">Worse:</span> <span class="keyword">if</span> greeting is <span class="string">True:</span></span><br></pre></td></tr></table></figure>
<h2 id="Class_继承">Class 继承</h2><p>当一个类被设计为基类的时候，要考虑到那些方法是要被子类覆盖的，那些是给子类用的（subclass API），那些只是基类用的</p>
<ul>
<li>公共属性，前面不应该有一个下划线</li>
<li>如果你的属性名与keyword或者其他什么的冲突，则可以考虑在尾部加一个下划线</li>
<li>对于简单的公共属性，直接用属性名访问，而不要像jave一样定义一些accessor/mutator methods，如果之后需要对于这个属性进行额外处理， 那么可以使用<code>@property</code>来强化这个属性（防止用property来计算复杂属性）</li>
<li>如果你的类可能被继承，则把那些不想被子类使用的属性和方法用两个下划线开头</li>
</ul>
<h3 id="super()_还是_BaseClass()">super() 还是 BaseClass()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span>:</span></span><br><span class="line">    name = <span class="string">"Base"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span><span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sub</span><span class="params">(Base)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment">#Base.__init__(self)</span></span><br><span class="line">        super().__init__()</span><br></pre></td></tr></table></figure>
<p>这两种方法都可以用作调用父类初始化函数，但是super()更好，不会在菱形继承中导致一些重复初始化的问题</p>
<p>为了弄清它的原理，我们需要花点时间解释下Python是如何实现继承的。对于你定义的每一个类而已，Python会计算出一个所谓的方法解析顺序(MRO)列表。 这个MRO列表就是一个简单的所有基类的线性顺序表。例如：</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C.<span class="number">__m</span>ro<span class="number">__</span></span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">'__main__.C'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'__main__.A'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'__main__.B'</span>&gt;,</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">'__main__.Base'</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">'object'</span>&gt;)</span><br></pre></td></tr></table></figure>
<p>为了实现继承，Python会在MRO列表上从左到右开始查找基类，直到找到第一个匹配这个属性的类为止。</p>
<p>而这个MRO列表的构造是通过一个C3线性化算法来实现的。 我们不去深究这个算法的数学原理，它实际上就是合并所有父类的MRO列表并遵循如下三条准则：</p>
<ul>
<li>子类会先于父类被检查</li>
<li>多个父类会根据它们在列表中的顺序被检查</li>
<li>如果对下一个类存在两个合法的选择，选择第一个父类</li>
</ul>
<p>当你使用 <code>super()</code> 函数时，Python会在MRO列表上继续搜索下一个类。 只要每个重定义的方法统一使用 <code>super()</code> 并只调用它一次， 那么控制流最终会遍历完整个MRO列表，每个方法也只会被调用一次。 </p>
<p>我们来看下super的实现，可以发现他在找这个列表里后一个class</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">super</span><span class="params">(cls, inst)</span>:</span></span><br><span class="line">    mro = inst.__class__mro()</span><br><span class="line">    <span class="keyword">return</span> mro[mro.index(cls)+<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span>:</span></span><br><span class="line">    name = <span class="string">"Base"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">a = Base()</span><br><span class="line">print(a.name)</span><br><span class="line">a.name = <span class="string">"Base c"</span></span><br><span class="line">print(a.name)</span><br><span class="line">print(Base.name)</span><br><span class="line">print(<span class="string">'--------'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sub</span><span class="params">(Base)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        Base.__init__(self)</span><br><span class="line">    </span><br><span class="line">    <span class="decorator">@property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'property name'</span>)</span><br><span class="line">        print(Base.name)</span><br><span class="line">        Base.name = <span class="string">'abc'</span></span><br><span class="line">        print(super(Sub,self).name)</span><br><span class="line"></span><br><span class="line">b = Sub()</span><br><span class="line">b.name</span><br><span class="line">print(b.__dict__)</span><br><span class="line">print(Base.name)</span><br><span class="line">print(<span class="string">'--------'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sub2</span><span class="params">(Sub)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        Base.__init__(self)</span><br><span class="line">        print(super(Sub, self).name)</span><br><span class="line"></span><br><span class="line">c = Sub2()</span><br><span class="line">c.name</span><br><span class="line">print(c.__class__.mro())</span><br></pre></td></tr></table></figure>
<p>结果是：<br><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Base</span><br><span class="line">Base c</span><br><span class="line"><span class="header">Base</span><br><span class="line">--------</span></span><br><span class="line">property name</span><br><span class="line">Base</span><br><span class="line">abc</span><br><span class="line">&#123;&#125;</span><br><span class="line"><span class="header">abc</span><br><span class="line">--------</span></span><br><span class="line">abc</span><br><span class="line">property name</span><br><span class="line">abc</span><br><span class="line">abc</span><br><span class="line"><span class="attribute">[&lt;class '__main__.Sub2'&gt;, &lt;class '__main__.Sub'&gt;, &lt;class '__main__.Base'&gt;, &lt;class 'object'&gt;]</span></span><br></pre></td></tr></table></figure></p>
<h2 id="weakref">weakref</h2><p>List和Dict不支持weakref，但是他们的子类可以</p>
<h2 id="Unicode">Unicode</h2><p>为了解决多国语言的问题，ASCII显然已经不适合，他是用一个字节代表一个字符，这远远不够世界各种语言使用，Unicode是一个更大的集合，他包含了ASCII，因此他是一个变长的编码方式<br>我们有两种方式来声明一个str</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">str =</span> ‘abcd’ <span class="comment"># 这是一个str</span></span><br><span class="line"><span class="variable">uni =</span> u‘Hi \u2119\u2602’ <span class="comment"># 这是一个unicode类型</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>unicode.encode(‘UTF-8’) -&gt; bytes</code></li>
<li><code>bytes.decode(‘UTF-8’) -&gt; unicode</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">u'abcd'</span>.encode(<span class="string">'ascii'</span>, <span class="string">'replace'</span>) <span class="comment">#不能被encode就会变成一个`?`</span></span><br><span class="line"><span class="string">u'abcd'</span>.encode(<span class="string">'ascii'</span>, <span class="string">'xmlcharrefreplace'</span>) <span class="comment">#produces an HTML/XML character entity reference</span></span><br><span class="line"><span class="string">u'abcd'</span>.encode(<span class="string">'ascii'</span>, <span class="string">'ignore'</span>) <span class="comment">#ignore</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Python 2 will automatically decode the byte string to produce a second unicode string, then will complete the operation with the two unicode strings.</li>
<li>So “str” in Python 2 is now called “bytes,” and “unicode” in Python 2 is now called “str”. This makes more sense than the Python 2 names, since Unicode is how you want all text stored, and byte strings are only for when you are dealing with bytes.<br>[Pragmatic Unicode][<a href="http://nedbatchelder.com/text/unipain.html" target="_blank" rel="external">http://nedbatchelder.com/text/unipain.html</a>]</li>
</ul>
<h2 id="元类">元类</h2><h2 id="TIP">TIP</h2><h3 id="in">in</h3><p><code>if elem in alist</code> 用来检查元素是否在列表里，但是注意这里的elem必须是一个元素，不能是alist列表中的一个子集，他是不能够检查子集的。</p>
<h3 id="yeild">yeild</h3><p>generator可以包含一个return语句，但是他会导致generator不再能返回任何结果，而且return不能有返回值，<code>return 5</code>会报一个syntax error</p>
<h3 id="__占位符">_ 占位符</h3><p>可以像Haskell一样有个占位符<code>_</code> 来表示不关心的内容</p>
<h2 id="Flask">Flask</h2><h3 id="获得message_body">获得message body</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">request<span class="class">.form</span></span><br><span class="line">request<span class="class">.json</span></span><br><span class="line">request.headers</span><br></pre></td></tr></table></figure>
<h2 id="Functional_programming">Functional programming</h2><h3 id="generator_expression_and_list_comprehensions">generator expression and list comprehensions</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Generator expression -- returns iterator</span></span><br><span class="line">stripped_iter = (<span class="built_in">line</span>.strip() <span class="keyword">for</span> <span class="built_in">line</span> <span class="operator">in</span> line_list)</span><br><span class="line"></span><br><span class="line"><span class="comment"># List comprehension -- returns list</span></span><br><span class="line">stripped_list = [<span class="built_in">line</span>.strip() <span class="keyword">for</span> <span class="built_in">line</span> <span class="operator">in</span> line_list]</span><br></pre></td></tr></table></figure>
<p>List comprehension 会一次性返回所有的值，而generator expression返回一个可迭代的对象，他不会一次性返回所有值，只会根据需要获取，适合处理无限长度的数据。</p>
<h3 id="Passing_values_into_a_generator">Passing values into a generator</h3><p>In Python 2.4 and earlier, generators only produced output. Once a generator’s code was invoked to create an iterator, there was no way to pass any new information into the function when its execution is resumed. You could hack together this ability by making the generator look at a global variable or by passing in some mutable object that callers then modify, but these approaches are messy.<br>In Python 2.5 there’s a simple way to pass values into a generator. yield became an expression, returning a value that can be assigned to a variable or otherwise operated on:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">val</span> =</span> (<span class="keyword">yield</span> i)</span><br></pre></td></tr></table></figure>
<p>I recommend that you always put parentheses around a yield expression when you’re doing something with the returned value, as in the above example. The parentheses aren’t always necessary, but it’s easier to always add them instead of having to remember when they’re needed.</p>
<p>(PEP 342 explains the exact rules, which are that a yield-expression must always be parenthesized except when it occurs at the top-level expression on the right-hand side of an assignment. This means you can write val = yield i but have to use parentheses when there’s an operation, as in val = (yield i) + 12.)</p>
<p>Values are sent into a generator by calling its send(value) method. This method resumes the generator’s code and the yield expression returns the specified value. If the regular next() method is called, the yield returns None.</p>
<p>Here’s a simple counter that increments by 1 and allows changing the value of the internal counter.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">counter</span> <span class="params">(maximum)</span>:</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; maximum:</span><br><span class="line">        val = (<span class="keyword">yield</span> i)</span><br><span class="line">        <span class="comment"># If value provided, change counter</span></span><br><span class="line">        <span class="keyword">if</span> val <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">            i = val</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            i += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>And here’s an example of changing the counter:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;</span>&gt;</span><br><span class="line">&gt;&gt;&gt; it = counter(<span class="number">10</span>)</span><br><span class="line"><span class="prompt">&gt;&gt;</span>&gt; print it.next()</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="prompt">&gt;&gt;</span>&gt; print it.next()</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="prompt">&gt;&gt;</span>&gt; print it.send(<span class="number">8</span>)</span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="prompt">&gt;&gt;</span>&gt; print it.next()</span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="prompt">&gt;&gt;</span>&gt; print it.next()</span><br><span class="line"><span class="constant">Traceback</span> (most recent call last)<span class="symbol">:</span></span><br><span class="line">  <span class="constant">File</span> <span class="string">"t.py"</span>, line <span class="number">15</span>, <span class="keyword">in</span> ?</span><br><span class="line">    print it.<span class="keyword">next</span>()</span><br><span class="line"><span class="constant">StopIteration</span></span><br></pre></td></tr></table></figure>
<p>Because yield will often be returning None, you should always check for this case. Don’t just use its value in expressions unless you’re sure that the send() method will be the only method used to resume your generator function.</p>
<p>In addition to send(), there are two other new methods on generators:</p>
<ul>
<li><p>throw(type, value=None, traceback=None) is used to raise an exception inside the generator; the exception is raised by the yield expression where the generator’s execution is paused.</p>
</li>
<li><p>close() raises a GeneratorExit exception inside the generator to terminate the iteration. On receiving this exception, the generator’s code must either raise GeneratorExit or StopIteration; catching the exception and doing anything else is illegal and will trigger a RuntimeError. close() will also be called by Python’s garbage collector when the generator is garbage-collected.</p>
</li>
</ul>
<p>If you need to run cleanup code when a GeneratorExit occurs, I suggest using a try: … finally: suite instead of catching GeneratorExit.</p>
<p>The cumulative effect of these changes is to turn generators from one-way producers of information into both producers and consumers.</p>
<p>Generators also become coroutines, a more generalized form of subroutines. Subroutines are entered at one point and exited at another point (the top of the function, and a return statement), but coroutines can be entered, exited, and resumed at many different points (the yield statements).</p>
<h2 id="getattr">getattr</h2><ul>
<li>getattr(object, name[, default])<br>Return the value of the named attribute of object. name must be a string. If the string is the name of one of the object’s attributes, the result is the value of that attribute. For example, <code>getattr(x, &#39;foobar&#39;)</code> is equivalent to <code>x.foobar</code>. If the named attribute does not exist, default is returned if provided, otherwise AttributeError is raised.</li>
</ul>
<h2 id="class_type(object)">class type(object)</h2><ul>
<li>class type(object)</li>
<li>class type(name, bases, dict)<br>With one argument, return the type of an object. The return value is a type object and generally the same object as returned by object.<strong>class</strong>.</li>
</ul>
<p>The isinstance() built-in function is recommended for testing the type of an object, because it takes subclasses into account.</p>
<p>With three arguments, return a new type object. This is essentially a dynamic form of the class statement. The name string is the class name and becomes the <strong>name</strong> attribute; the bases tuple itemizes the base classes and becomes the <strong>bases</strong> attribute; and the dict dictionary is the namespace containing definitions for class body and becomes the <strong>dict</strong> attribute. For example, the following two statements create identical type objects:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;</span><br><span class="line">&gt;&gt;&gt; class X:</span><br><span class="line">...     <span class="tag">a</span> = <span class="number">1</span></span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; X = <span class="function"><span class="title">type</span><span class="params">(<span class="string">'X'</span>, (object,)</span></span>, <span class="function"><span class="title">dict</span><span class="params">(a=<span class="number">1</span>)</span></span>)</span><br></pre></td></tr></table></figure>
<h2 id="monkey_patch">monkey patch</h2><p>monkey patch指的是在运行时动态替换,一般是在startup的时候.</p>
<p>用过gevent就会知道,会在最开头的地方gevent.monkey.patch_all();把标准库中的thread/socket等给替换掉.这样我们在后面使用socket的时候可以跟平常一样使用,无需修改任何代码,但是它变成非阻塞的了. 之前做的一个游戏服务器,很多地方用的import json,后来发现ujson比自带json快了N倍,于是问题来了,难道几十个文件要一个个把import json改成import ujson as json吗? 其实只需要在进程startup的地方monkey patch就行了.是影响整个进程空间的.</p>
<p>同一进程空间中一个module只会被运行一次.<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> ujson</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">monkey_patch_json</span><span class="params">()</span>:</span></span><br><span class="line">  json.__name__ = <span class="string">'ujson'</span></span><br><span class="line">  json.dumps = ujson.dumps</span><br><span class="line">  json.loads = ujson.loads</span><br><span class="line"></span><br><span class="line">monkey_patch_json()</span><br><span class="line"><span class="keyword">print</span> <span class="string">'main.py'</span>,json.__name__</span><br><span class="line"><span class="keyword">import</span> sub</span><br></pre></td></tr></table></figure></p>
<p>sub.py<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="reserved">import</span> json</span><br><span class="line"><span class="built_in">print</span> <span class="string">'sub.py'</span>,json.__name__</span><br></pre></td></tr></table></figure></p>
<h2 id="with">with</h2><p>如下情况 with一旦结束，那么as后面的对象就会被清除，即便是赋值给了c.response，那只是一个引用，除非用deepcopy<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">with urllib<span class="class">.request</span><span class="class">.urlopen</span>(c<span class="class">.request</span>, context=context) as response:</span><br><span class="line">    c<span class="class">.response</span> = response</span><br><span class="line">    return c</span><br><span class="line"></span><br><span class="line">#<span class="function"><span class="title">print</span><span class="params">(c.response.read()</span></span>)</span><br><span class="line"><span class="id">#return</span> c</span><br></pre></td></tr></table></figure></p>
<h2 id="pdb">pdb</h2><p>可以通过代用<code>set_trace()</code>来设置一个断点，然后运行的时候就会自动进入pdb，然后就可以调试啦<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> inspect</span><br><span class="line"><span class="keyword">import</span> pdb</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span>:</span><span class="keyword">pass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">b</span><span class="params">(a)</span>:</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">c</span><span class="params">(a)</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">hell</span><span class="params">(self)</span>:</span></span><br><span class="line">            print(inspect.getmodule(self))</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">guess</span><span class="params">(self)</span>:</span></span><br><span class="line">            self.hell()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self)</span>:</span></span><br><span class="line">        cc = self.c()</span><br><span class="line">        pdb.set_trace()</span><br><span class="line">        cc.guess()</span><br><span class="line"></span><br><span class="line">cc()</span><br></pre></td></tr></table></figure></p>
<h2 id="Reference">Reference</h2><ol>
<li><a href="https://www.python.org/dev/peps/pep-0008/" target="_blank" rel="external">PEP 0008 — Style Guide for Python Code</a></li>
</ol>

      
    </div>

    <div class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/"> #python </a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
              <a href="/2014-9-12-cpp-note/">C\C++ Notes</a>
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/2014-9-2-shell-note/">SHELL Command/Script Notes</a>
            
          </div>
        </div>
      

      
      
    </div>
  </div>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>

    
      <div class="comments" id="comments">
        
      </div>
    
  </div>


        </div>

        
      </div>


      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目錄
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            本站概覽
          </li>
        </ul>
      

      <div class="site-overview">
        <div class="site-author motion-element">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="Matthew Gao" />
          <p class="site-author-name">Matthew Gao</p>
        </div>
        <p class="site-description motion-element"></p>
        <div class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">24</span>
              <span class="site-state-item-name">文章</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">13</span>
              <span class="site-state-item-name">分類</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">35</span>
              <span class="site-state-item-name">標籤</span>
              </a>
          </div>

        </div>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
              <a href="https://github.com/matthewgao" target="_blank">Github</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="https://www.v2ex.com/member/matthewgao" target="_blank">V2EX</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="https://cn.linkedin.com/in/gaoshen" target="_blank">LinkedIn</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://weibo.com/334332999" target="_blank">Weibo</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://douban.com/people/mrgao" target="_blank">Douban</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="http://www.zhihu.com/people/gaoshen" target="_blank">Zhihu</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="https://twitter.com/xxiaogao" target="_blank">Twitter</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="https://www.facebook.com/gao.jl" target="_blank">FaceBook</a>
            </span>
            
              <span class="links-of-author-item">
              <a href="mailto:matthewgao@gmail.com" target="_blank">Gmail</a>
            </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>
        
      </div>

      
        <div class="post-toc-wrap sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator"></div>
          <div class="post-toc">
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Pypi镜像"><span class="nav-number">1.</span> <span class="nav-text">Pypi镜像</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#模块"><span class="nav-number">2.</span> <span class="nav-text">模块</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#from_import"><span class="nav-number">2.1.</span> <span class="nav-text">from import</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#类"><span class="nav-number">3.</span> <span class="nav-text">类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#内建属性"><span class="nav-number">3.1.</span> <span class="nav-text">内建属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#委托"><span class="nav-number">3.2.</span> <span class="nav-text">委托</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数"><span class="nav-number">4.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#闭包"><span class="nav-number">4.1.</span> <span class="nav-text">闭包</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Decorator"><span class="nav-number">5.</span> <span class="nav-text">Decorator</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Singleton"><span class="nav-number">5.1.</span> <span class="nav-text">Singleton</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#规范"><span class="nav-number">6.</span> <span class="nav-text">规范</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#命名规则"><span class="nav-number">6.1.</span> <span class="nav-text">命名规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#编程规范"><span class="nav-number">6.2.</span> <span class="nav-text">编程规范</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#import顺序"><span class="nav-number">6.3.</span> <span class="nav-text">import顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#类设计"><span class="nav-number">6.4.</span> <span class="nav-text">类设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Programming_Recommendations"><span class="nav-number">6.5.</span> <span class="nav-text">Programming Recommendations</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Class_继承"><span class="nav-number">7.</span> <span class="nav-text">Class 继承</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#super()_还是_BaseClass()"><span class="nav-number">7.1.</span> <span class="nav-text">super() 还是 BaseClass()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#weakref"><span class="nav-number">8.</span> <span class="nav-text">weakref</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Unicode"><span class="nav-number">9.</span> <span class="nav-text">Unicode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#元类"><span class="nav-number">10.</span> <span class="nav-text">元类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TIP"><span class="nav-number">11.</span> <span class="nav-text">TIP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#in"><span class="nav-number">11.1.</span> <span class="nav-text">in</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#yeild"><span class="nav-number">11.2.</span> <span class="nav-text">yeild</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#__占位符"><span class="nav-number">11.3.</span> <span class="nav-text">_ 占位符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Flask"><span class="nav-number">12.</span> <span class="nav-text">Flask</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#获得message_body"><span class="nav-number">12.1.</span> <span class="nav-text">获得message body</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Functional_programming"><span class="nav-number">13.</span> <span class="nav-text">Functional programming</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#generator_expression_and_list_comprehensions"><span class="nav-number">13.1.</span> <span class="nav-text">generator expression and list comprehensions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Passing_values_into_a_generator"><span class="nav-number">13.2.</span> <span class="nav-text">Passing values into a generator</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#getattr"><span class="nav-number">14.</span> <span class="nav-text">getattr</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#class_type(object)"><span class="nav-number">15.</span> <span class="nav-text">class type(object)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#monkey_patch"><span class="nav-number">16.</span> <span class="nav-text">monkey patch</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#with"><span class="nav-number">17.</span> <span class="nav-text">with</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pdb"><span class="nav-number">18.</span> <span class="nav-text">pdb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">19.</span> <span class="nav-text">Reference</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator"></div>
        </div>
      

    </div>
  </div>


    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp;  2012 - 
  2015
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">Matthew Gao</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 強力驅動
</div>

<div class="theme-info">
  主題 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.3"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.3"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.3" id="motion.global"></script>



  <script type="text/javascript" src="/js/search-toggle.js"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.3" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var $sidebarInner = $('.sidebar-inner');
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.didShow', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;
          var self = this;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      $(indicator).velocity('stop').velocity({
        opacity: action === 'show' ? 0.4 : 0
      }, { duration: 100 });
    }

  });
</script>


  <script type="text/javascript" id="sidebar.nav">
    $(document).ready(function () {
      var html = $('html');

      $('.sidebar-nav li').on('click', function () {
        var item = $(this);
        var activeTabClassName = 'sidebar-nav-active';
        var activePanelClassName = 'sidebar-panel-active';
        if (item.hasClass(activeTabClassName)) {
          return;
        }

        var currentTarget = $('.' + activePanelClassName);
        var target = $('.' + item.data('target'));

        currentTarget.velocity('transition.slideUpOut', 200, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', 200)
            .addClass(activePanelClassName);
        });

        item.siblings().removeClass(activeTabClassName);
        item.addClass(activeTabClassName);
      });

      $('.post-toc a').on('click', function (e) {
        e.preventDefault();
        var offset = $(escapeSelector(this.getAttribute('href'))).offset().top;
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        });
      });

      // Expand sidebar on post detail page by default, when post has a toc.
      var $tocContent = $('.post-toc-content');
      if (isDesktop() && CONFIG.sidebar === 'post') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          displaySidebar();
        }
      }
    });
  </script>




  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  

  
  
  

  




  
  

</body>
</html>
